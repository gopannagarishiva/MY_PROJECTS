from Tkinter import *
from PIL import ImageTk,Image
from mininet.net import Mininet
from mininet.node import Controller
from mininet.cli import CLI
from mininet.log import setLogLevel,info
from Crypto.Cipher import AES
import base64
import os
import time
import socket

window=Tk()

#AES variables
Servers_ip='127.0.1.77'
BLOCK_SIZE=16
PADDING="{"
random=os.urandom(BLOCK_SIZE)
key=AES.new(random)
#creating mininet
net=Mininet(controller=Controller)

#functions
def StartbuttonClicked():
	ExcecutionPlace.insert(END,"****Adding Controller****")
	ExcecutionPlace.insert(END,"C0")
	net.addController("C0")
	ExcecutionPlace.insert(END,"****Adding Hosts(101)*****")
	ExcecutionPlace.insert(END,"h0: Server")
	ExcecutionPlace.insert(END,"****Adding Client host h1-h100****")
	h0=net.addHost("H0",ip="10.0.0.1")
	h1=net.addHost("H1",ip="10.0.0.2")
	h2=net.addHost("H2",ip="10.0.0.3")
	h3=net.addHost("H3",ip="10.0.0.4")
	h4=net.addHost("H4",ip="10.0.0.5")
	h5=net.addHost("H5",ip="10.0.0.6")
	h6=net.addHost("H6",ip="10.0.0.7")
        h7=net.addHost("H7",ip="10.0.0.8")
        h8=net.addHost("H8",ip="10.0.0.9")
        h9=net.addHost("H9",ip="10.0.0.10")
        h10=net.addHost("H10",ip="10.0.0.11")
        h11=net.addHost("H11",ip="10.0.0.12")
        h12=net.addHost("H12",ip="10.0.0.13")
        h13=net.addHost("H13",ip="10.0.0.14")
        h14=net.addHost("H14",ip="10.0.0.15")
        h15=net.addHost("H15",ip="10.0.0.16")
        h16=net.addHost("H16",ip="10.0.0.17")
        h17=net.addHost("H17",ip="10.0.0.18")
        h18=net.addHost("H18",ip="10.0.0.19")
        h19=net.addHost("H19",ip="10.0.0.20")
        h20=net.addHost("H20",ip="10.0.0.21")
        h21=net.addHost("H21",ip="10.0.0.22")
        h22=net.addHost("H22",ip="10.0.0.23")
        h23=net.addHost("H23",ip="10.0.0.24")
        h24=net.addHost("H24",ip="10.0.0.25")
        h25=net.addHost("H25",ip="10.0.0.26")
        h26=net.addHost("H26",ip="10.0.0.27")
        h27=net.addHost("H27",ip="10.0.0.28")
        h28=net.addHost("H28",ip="10.0.0.29")
        h29=net.addHost("H29",ip="10.0.0.30")
        h30=net.addHost("H30",ip="10.0.0.31")
        h31=net.addHost("H31",ip="10.0.0.32")
        h32=net.addHost("H32",ip="10.0.0.33")
        h33=net.addHost("H33",ip="10.0.0.34")
        h34=net.addHost("H34",ip="10.0.0.35")
        h35=net.addHost("H35",ip="10.0.0.36")
        h36=net.addHost("H36",ip="10.0.0.37")
        h37=net.addHost("H37",ip="10.0.0.38")
        h38=net.addHost("H38",ip="10.0.0.39")
        h39=net.addHost("H39",ip="10.0.0.40")
        h40=net.addHost("H40",ip="10.0.0.41")
        h41=net.addHost("H41",ip="10.0.0.42")
        h42=net.addHost("H42",ip="10.0.0.43")
        h43=net.addHost("H43",ip="10.0.0.44")
        h44=net.addHost("H44",ip="10.0.0.45")
        h45=net.addHost("H45",ip="10.0.0.46")
        h46=net.addHost("H46",ip="10.0.0.47")
        h47=net.addHost("H47",ip="10.0.0.48")
        h48=net.addHost("H48",ip="10.0.0.49")
        h49=net.addHost("H49",ip="10.0.0.50")
        h50=net.addHost("H50",ip="10.0.0.51")
        h51=net.addHost("H51",ip="10.0.0.52")
        h52=net.addHost("H52",ip="10.0.0.53")
        h53=net.addHost("H53",ip="10.0.0.54")
        h54=net.addHost("H54",ip="10.0.0.55")
        h55=net.addHost("H55",ip="10.0.0.56")
        h56=net.addHost("H56",ip="10.0.0.57")
        h57=net.addHost("H57",ip="10.0.0.58")
        h58=net.addHost("H58",ip="10.0.0.59")
        h59=net.addHost("H59",ip="10.0.0.60")
        h60=net.addHost("H60",ip="10.0.0.61")
        h61=net.addHost("H61",ip="10.0.0.62")
        h62=net.addHost("H62",ip="10.0.0.63")
        h63=net.addHost("H63",ip="10.0.0.64")
        h64=net.addHost("H64",ip="10.0.0.65")
        h65=net.addHost("H65",ip="10.0.0.66")
        h66=net.addHost("H66",ip="10.0.0.67")
        h67=net.addHost("H67",ip="10.0.0.68")
        h68=net.addHost("H68",ip="10.0.0.69")
        h69=net.addHost("H69",ip="10.0.0.70")
        h70=net.addHost("H70",ip="10.0.0.71")
        h71=net.addHost("H71",ip="10.0.0.72")
        h72=net.addHost("H72",ip="10.0.0.73")
        h73=net.addHost("H73",ip="10.0.0.74")
        h74=net.addHost("H74",ip="10.0.0.75")
        h75=net.addHost("H75",ip="10.0.0.76")
        h76=net.addHost("H76",ip="10.0.0.77")
        h77=net.addHost("H77",ip="10.0.0.78")
        h78=net.addHost("H78",ip="10.0.0.79")
        h79=net.addHost("H79",ip="10.0.0.80")
        h80=net.addHost("H80",ip="10.0.0.81")
        h81=net.addHost("H81",ip="10.0.0.81")
        h82=net.addHost("H82",ip="10.0.0.83")
        h83=net.addHost("H83",ip="10.0.0.84")
        h84=net.addHost("H84",ip="10.0.0.85")
        h85=net.addHost("H85",ip="10.0.0.86")
        h86=net.addHost("H86",ip="10.0.0.87")
        h87=net.addHost("H87",ip="10.0.0.88")
        h88=net.addHost("H88",ip="10.0.0.89")
        h89=net.addHost("H89",ip="10.0.0.90")
        h90=net.addHost("H90",ip="10.0.0.91")
        h91=net.addHost("H91",ip="10.0.0.92")
        h92=net.addHost("H92",ip="10.0.0.93")
        h93=net.addHost("H93",ip="10.0.0.94")
        h94=net.addHost("H94",ip="10.0.0.95")
        h95=net.addHost("H95",ip="10.0.0.96")
        h96=net.addHost("H96",ip="10.0.0.97")
        h97=net.addHost("H97",ip="10.0.0.98")
        h98=net.addHost("H98",ip="10.0.0.99")
        h99=net.addHost("H99",ip="10.0.0.100")
        h100=net.addHost("H100",ip="10.0.0.101")
	ExcecutionPlace.insert(END,"h1,h2,h3,h4....,h99,h100")
	ExcecutionPlace.insert(END,"****Adding Switchs(10)****")
	s1=net.addSwitch("s1")
	s2=net.addSwitch("s2")
	s3=net.addSwitch("s3")
	s4=net.addSwitch("s4")
	s5=net.addSwitch("s5")
	s6=net.addSwitch("s6")
	s7=net.addSwitch("s7")
	s8=net.addSwitch("s8")
	s9=net.addSwitch("s9")
	s10=net.addSwitch("s10")
	ExcecutionPlace.insert(END,"s1,s2,s3,s4,s5,s6,s7,s8,s9,s10")
	ExcecutionPlace.insert(END,"****Adding Links****")
	ExcecutionPlace.insert(END,"s1->h1-h10, s2->h11-h20, s3->h21-h30, s4->h31-h40, s5->h41-h50, s6->h51-60, s7->h61-h70, s8->h71-h80, s9->h81-h90, s10->h91-h100")
	ExcecutionPlace.insert(END,"ALl Switchs are connecting to Server(H0)")
	net.addLink(h1,s1)
	net.addLink(h2,s1)
	net.addLink(h3,s1)
	net.addLink(h4,s1)
	net.addLink(h5,s1)
	net.addLink(h6,s1)
	net.addLink(h7,s1)
	net.addLink(h8,s1)
	net.addLink(h9,s1)
	net.addLink(h10,s1)
        net.addLink(h11,s2)
        net.addLink(h12,s2)
        net.addLink(h13,s2)
        net.addLink(h14,s2)
        net.addLink(h15,s2)
        net.addLink(h16,s2)
        net.addLink(h17,s2)
        net.addLink(h18,s2)
        net.addLink(h19,s2)
        net.addLink(h20,s2)
        net.addLink(h21,s3)
        net.addLink(h22,s3)
        net.addLink(h23,s3)
        net.addLink(h24,s3)
        net.addLink(h25,s3)
        net.addLink(h26,s3)
        net.addLink(h27,s3)
        net.addLink(h28,s3)
        net.addLink(h29,s3)
        net.addLink(h30,s3)
        net.addLink(h31,s4)
        net.addLink(h32,s4)
        net.addLink(h33,s4)
        net.addLink(h34,s4)
        net.addLink(h35,s4)
        net.addLink(h36,s4)
        net.addLink(h37,s4)
        net.addLink(h38,s4)
        net.addLink(h39,s4)
        net.addLink(h40,s4)
        net.addLink(h41,s5)
        net.addLink(h42,s5)
        net.addLink(h43,s5)
        net.addLink(h44,s5)
        net.addLink(h45,s5)
        net.addLink(h46,s5)
        net.addLink(h47,s5)
        net.addLink(h48,s5)
        net.addLink(h49,s5)
        net.addLink(h50,s5)
        net.addLink(h51,s6)
        net.addLink(h52,s6)
        net.addLink(h53,s6)
        net.addLink(h54,s6)
        net.addLink(h55,s6)
        net.addLink(h56,s6)
        net.addLink(h57,s6)
        net.addLink(h58,s6)
        net.addLink(h59,s6)
        net.addLink(h60,s6)
        net.addLink(h61,s7)
        net.addLink(h62,s7)
        net.addLink(h63,s7)
        net.addLink(h64,s7)
        net.addLink(h65,s7)
        net.addLink(h66,s7)
        net.addLink(h67,s7)
        net.addLink(h68,s7)
        net.addLink(h69,s7)
        net.addLink(h70,s7)
        net.addLink(h71,s8)
        net.addLink(h72,s8)
        net.addLink(h73,s8)
        net.addLink(h74,s8)
        net.addLink(h75,s8)
        net.addLink(h76,s8)
        net.addLink(h77,s8)
        net.addLink(h78,s8)
        net.addLink(h79,s8)
        net.addLink(h80,s8)
        net.addLink(h81,s9)
        net.addLink(h82,s9)
        net.addLink(h83,s9)
        net.addLink(h84,s9)
        net.addLink(h85,s9)
        net.addLink(h86,s9)
        net.addLink(h87,s9)
        net.addLink(h88,s9)
        net.addLink(h89,s9)
        net.addLink(h90,s9)
        net.addLink(h91,s10)
        net.addLink(h92,s10)
        net.addLink(h93,s10)
        net.addLink(h94,s10)
        net.addLink(h95,s10)
        net.addLink(h96,s10)
        net.addLink(h97,s10)
        net.addLink(h98,s10)
        net.addLink(h99,s10)
        net.addLink(h100,s10)
        net.addLink(h0,s1)
        net.addLink(h0,s2)
        net.addLink(h0,s3)
        net.addLink(h0,s4)
        net.addLink(h0,s5)
        net.addLink(h0,s6)
        net.addLink(h0,s7)
        net.addLink(h0,s8)
        net.addLink(h0,s9)
        net.addLink(h0,s10)
	#starting Network
	net.start()
	CLI(net)
def StopbuttonClicked():
	net.stop()
def ClientsMessage():
	connection=socket.socket()
	connection.connect((Servers_ip,9999))
	ExcecutionPlace.insert(END,">>SENT")
	connection.send(clientvariable1.get())
	ExcecutionPlace.insert(END,'<<Recieved')
	recievd=str.decode(connection.recv(1024))
	encodedText=encode(recievd)
	clientvariable3.set(encodedText)
	#clientvariable3.set(recievd)
	connection.close()
def padding(message):
	return message + (BLOCK_SIZE-len(message)%BLOCK_SIZE)*PADDING
def encode(message):
	return base64.b64encode(key.encrypt(padding(message)))
def encrypt(message):
	encodeText=encode(message)
	ExcecutionPlace.insert(END,'Encrypted...')
	clientvariable2.set(encodeText)
def decryptMessage():
	ExcecutionPlace.insert(END,'Decrypted...')
	decryptedString=key.decrypt(base64.b64decode(clientvariable3.get())).rstrip(PADDING)
	clientvariable4.set(decryptedString)
#configuring main window
window.maxsize(width=1000,height=650)
window.minsize(width=1000,height=650)
window.bg="lavender"

#Frame for the excecution place
ExcecutionPlaceFrame=Frame(window,width=143)
ExcecutionPlaceFrame.place(x=0,y=478)

#Excecution place
ExcecutionPlace=Listbox(ExcecutionPlaceFrame,width=143,bg="lavender")
ExcecutionPlace.pack()

#Frame for the Top of the excecution place
ExcecutionPlaceFrameTop=Frame(window,width=1000,height=30,highlightbackground="black",highlightthickness=1,bg="gainsboro")
ExcecutionPlaceFrameTop.place(x=0,y=448)


#Frame for the image
ImageFrame=Frame(window,width=438,height=447,highlightbackground="black",highlightthickness=1)
ImageFrame.place(x=561,y=0)

#setting the image
topoImage=Image.open("View-using-the-OpenDaylight-ODL-SDN-Controller3.png")
topoImage=topoImage.resize((433, 442), Image.ANTIALIAS)
Imagetopo=ImageTk.PhotoImage(topoImage)
ImageLabel=Label(ImageFrame,image=Imagetopo,bg="gainsboro")
ImageLabel.pack()

#Labels in the ExcecutionFrame
runLabel=Label(ExcecutionPlaceFrameTop,text="RUN: ",bg="gainsboro")
runLabel.place(x=0,y=0)

#Mininet start and Stop Buttons Frame
ButtonsFrame=Frame(window,width=560,height=30,highlightbackground="black",highlightthickness=1)
ButtonsFrame.place(x=0,y=20)

#Start and stop buttons
startButton=Button(ButtonsFrame,text="START",width=15,command=StartbuttonClicked)
startButton.place(x=0,y=0)
startButton=Button(ButtonsFrame,text="STOP",width=15,command=StopbuttonClicked)
startButton.place(x=132,y=0)

#Clint side UI
ClientFrame=Frame(window,width=280,height=398,highlightbackground="black",highlightthickness=1).place(x=0,y=50)
CLientLabel=Label(ClientFrame,text="CLIENT").place(x=5,y=60)
clientvariable1=StringVar()
clientEntry1=Entry(ClientFrame,textvariable=clientvariable1,width=17).place(x=5,y=130)
clientButton1=Button(ClientFrame,text="Encrypt",width=11,command=lambda:encrypt(clientvariable1.get())).place(x=155,y=130)
clientvariable2=StringVar()
clientEntry2=Entry(ClientFrame,textvariable=clientvariable2,width=32).place(x=5,y=160)
clientButton2=Button(ClientFrame,text="SEND",width=30,command=ClientsMessage).place(x=5,y=190)
clientvariable3=StringVar()
clientEntry3=Entry(ClientFrame,textvariable=clientvariable3,width=17).place(x=5,y=280)
clientButton3=Button(ClientFrame,text="Decrypt",width=11,command=decryptMessage).place(x=155,y=280)
clientvariable4=StringVar()
clientEntry4=Entry(ClientFrame,textvariable=clientvariable4,width=33).place(x=5,y=310)
#drop-Down Menu/Option menu For ClientSIde UI
var=StringVar(window)
var.set("select")
choices={'h1','h2','h3','h4','h5','h6','h7','h8','h9','h10','h11','h12','h13','h14','h15','h16','h17','h18','h19','h20','h21','h22','h23','h24','h25','h26','h27','h28','h29','h30','h31','h32','h33','h34','h35','h36','h37','h38','h39','h40','h41','h42','h43','h44','h45','h46','h47','h48','h49','h50','h51','h52','h53','h54','h55','h56','h57','h58','h59','h60','h61','h62','h63','h64','h65','h66','h67','h68','h69','h70','h71','h72','h73','h74','h75','h76','h77','h78','h79','h80','h81','h82','h83','h84','h85','h86','h87','h88','h89','h90','h91','h92','h93','h94','h95','h96','h97','h98','h99','h100'}
dropdownMenu=OptionMenu(window,var,*choices).place(x=60,y=56,width=200)

#Server Side UI
#ServerFrame=Frame(window,width=280,height=398,highlightbackground="black",highlightthickness=1).place(x=280,y=50)
#ServerLabel=Label(ServerFrame,text="SERVER").place(x=500,y=60)
#servervariable1=StringVar()
#ServerEntry1=Entry(ServerFrame,textvariable=servervariable1,width=17).place(x=290,y=130)
#srverButton1=Button(ServerFrame,text="Decrypt",width=11).place(x=435,y=130)
#Servervariable2=StringVar()
#ServerEntry2=Entry(ServerFrame,textvariable=Servervariable2,width=32).place(x=289,y=160)
#servervariable3=StringVar()
#ServerEntry3=Entry(ServerFrame,textvariable=servervariable3,width=17).place(x=290,y=280)
#srverButton3=Button(ServerFrame,text="Encrypt",width=11).place(x=435,y=280)
#Servervariable4=StringVar()
#ServerEntry4=Entry(ServerFrame,textvariable=Servervariable4,width=32).place(x=289,y=310)
#ServerButton2=Button(ServerFrame,text="SEND",width=30).place(x=289,y=340)

window.mainloop()
